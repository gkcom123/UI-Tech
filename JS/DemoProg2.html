<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<script>
  function StateMachine(initialState) {
    this.state = initialState || 'foo';
    return {
      transition: function() {
        this.state = {foo:'bar', bar:'quux', quux:'foo'}[this.state];
        return this;
      }
    };
  }
  var sm = new StateMachine();
  //console.log(sm);
  alert(sm.transition().transition().state);
</script>

</body>
</html>
